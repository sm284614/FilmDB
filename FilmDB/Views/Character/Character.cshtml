@using FilmDB.Models
@model IEnumerable<CharacterCount>
@{
    ViewData["Title"] = "Film Characters";
}
<div class="sub-container">
    <div class="d-flex justify-content-between align-items-center">
        <h1>Film Characters</h1>
        <form id="characterSearchForm" class="d-flex">
            <input type="text" id="characterSearchQuery" name="characterSearchQuery" class="form-control me-2" placeholder="Search Characters" required />
            <button type="submit" class="btn btn-primary">Search</button>
        </form>
    </div>
    
    @if (Model != null && Model.Any())
    {
        <div id="wordCloudContainer" class="mt-4">
            <h3>Iconic Characters</h3>
            <p class="text-muted">Click any character to view details</p>
            <canvas id="characterCloud"></canvas>
        </div>
        <!-- Hidden data for JavaScript -->
        <script id="characterData" type="application/json">
            @Html.Raw(System.Text.Json.JsonSerializer.Serialize(
                Model.Select(cc => new { 
                    text = cc.Character.Name, 
                    weight = cc.Count,
                    characterId = cc.Character.CharacterId 
                })
            ))
        </script>
    }
    <div id="characterTableContainer" class="sub-container mt-3" >
        <!-- Search results will appear here -->
    </div>
</div>

<script src="~/lib/wordcloud2.min.js"></script>
<script src="~/js/wordCloud.js"></script>
<script src="~/js/chcracterSearch.js"></script>

<style>
    #characterCloud {
        cursor: default;
        width: 100%; 
        height:600px; 
        border: 1px solid #dee2e6; 
        border-radius: 8px;
    }
</style>